---
import Badge from "@/components/ui/Badge.astro";
import Button from "@/components/ui/Button.astro";

interface Props {
  name: string;
  subtitle: string;
  description: string;
  features: string[];
  cta: string;
  featured?: boolean;
  href?: string;
}

const {
  name,
  subtitle,
  description,
  features,
  cta,
  featured = false,
  href = "#contact",
} = Astro.props;
---

<div class={`card service-card ${featured ? "service-card--featured" : ""}`}>
  {
    featured && (
      <div class="service-card__badge">
        <Badge variant="primary" class="most-popular-badge">
          Most Popular
        </Badge>
      </div>
    )
  }

  <!-- Service Header -->
  <div class="service-card__header">
    <Badge variant={featured ? "primary" : "secondary"} class="mb-md">
      {subtitle}
    </Badge>

    <h3 class="service-card__title">{name}</h3>

    <div class="service-card__quote">
      <div class="service-card__quote-text">Get Quote</div>
      <div class="service-card__quote-subtext">
        Custom pricing based on scope
      </div>
    </div>

    <p class="service-card__description">{description}</p>
  </div>

  <!-- Features -->
  <div class="service-card__features">
    <h4 class="service-card__features-title">Includes:</h4>
    <ul class="service-card__features-list">
      {
        features.map((feature, index) => (
          <li class="service-card__feature">
            <div
              class={`service-card__feature-icon ${index % 2 === 0 ? "service-card__feature-icon--primary" : "service-card__feature-icon--secondary"}`}
            >
              <svg
                width="10"
                height="10"
                fill="none"
                stroke="currentColor"
                stroke-width="2.5"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  d="M5 13l4 4L19 7"
                />
              </svg>
            </div>
            <span class="service-card__feature-text">{feature}</span>
          </li>
        ))
      }
    </ul>
  </div>

  <!-- CTA Button -->
  <div class="service-card__cta">
    <Button variant={featured ? "primary" : "secondary"} fullWidth href={href}>
      {cta}
    </Button>
  </div>
</div>

<style>
  .service-card {
    position: relative;
    height: 100%;
    min-height: 480px;
    display: flex;
    flex-direction: column;
    padding: var(--space-xl);
    margin-top: var(--space-sm);
    overflow: visible;
  }

  .service-card--featured {
    border: 2px solid rgba(42, 143, 255, 0.3);
    background: linear-gradient(
      135deg,
      rgba(42, 143, 255, 0.02) 0%,
      rgba(42, 143, 255, 0.05) 100%
    );
    transform: scale(1.02);
    box-shadow: 0 8px 30px rgba(42, 143, 255, 0.15);
    margin-top: var(--space-2xl);
    overflow: visible;
    isolation: isolate;
  }

  .service-card--featured:hover {
    border-color: rgba(42, 143, 255, 0.5);
    box-shadow: 0 12px 40px rgba(42, 143, 255, 0.2);
    transform: scale(1.02) translateY(-2px);
  }

  .service-card__badge {
    position: absolute;
    top: -20px;
    left: 50%;
    transform: translateX(-50%);
    z-index: 100;
    animation: featured-pulse 3s ease-in-out infinite;
    filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.1));
    pointer-events: none;
  }

  @keyframes featured-pulse {
    0%,
    100% {
      transform: translateX(-50%) scale(1);
      opacity: 1;
    }
    50% {
      transform: translateX(-50%) scale(1.05);
      opacity: 0.9;
    }
  }

  .service-card--featured:hover .service-card__badge {
    animation-play-state: paused;
    transform: translateX(-50%) scale(1.1);
    filter: drop-shadow(0 6px 12px rgba(42, 143, 255, 0.2));
  }

  .most-popular-badge {
    background: linear-gradient(
      135deg,
      rgba(42, 143, 255, 1) 0%,
      rgba(34, 176, 126, 1) 100%
    ) !important;
    color: white !important;
    font-weight: var(--font-weight-bold) !important;
    font-size: var(--font-size-2xs) !important;
    padding: var(--space-sm) var(--space-lg) !important;
    border-radius: var(--radius-full) !important;
    text-transform: uppercase !important;
    letter-spacing: 0.08em !important;
    border: 2px solid rgba(255, 255, 255, 0.4) !important;
    box-shadow:
      0 4px 16px rgba(42, 143, 255, 0.4),
      0 0 20px rgba(42, 143, 255, 0.2),
      inset 0 1px 0 rgba(255, 255, 255, 0.3) !important;
    backdrop-filter: blur(10px) !important;
    white-space: nowrap !important;
  }

  .service-card--featured:hover .most-popular-badge {
    background: linear-gradient(
      135deg,
      rgba(42, 143, 255, 1) 0%,
      rgba(34, 176, 126, 1) 100%
    ) !important;
    border-color: rgba(255, 255, 255, 0.5) !important;
    box-shadow: 0 6px 16px rgba(42, 143, 255, 0.4) !important;
  }

  /* Responsive badge adjustments */
  @media (max-width: 768px) {
    .service-card__badge {
      top: -18px;
    }

    .most-popular-badge {
      font-size: var(--font-size-3xs) !important;
      padding: var(--space-xs) var(--space-md) !important;
    }
  }

  @media (max-width: 480px) {
    .service-card__badge {
      top: -16px;
    }

    .most-popular-badge {
      padding: 6px var(--space-sm) !important;
      letter-spacing: 0.06em !important;
    }
  }

  .service-card__header {
    margin-bottom: var(--space-xl);
    text-align: center;
    flex-shrink: 0;
  }

  .service-card__title {
    color: var(--color-text-primary);
    margin-bottom: var(--space-sm);
    font-size: var(--font-size-xl);
    font-weight: var(--font-weight-bold);
  }

  .service-card__quote {
    margin-bottom: var(--space-md);
  }

  .service-card__quote-text {
    color: var(--color-text-primary);
    font-size: var(--font-size-2xl);
    font-weight: var(--font-weight-bold);
  }

  .service-card__quote-subtext {
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
  }

  .service-card__description {
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    line-height: var(--line-height-relaxed);
  }

  .service-card__features {
    margin-bottom: var(--space-xl);
    flex: 1;
  }

  .service-card__features-title {
    color: var(--color-text-primary);
    margin-bottom: var(--space-md);
    font-size: var(--font-size-sm);
    font-weight: var(--font-weight-semibold);
  }

  .service-card__features-list {
    display: flex;
    flex-direction: column;
    gap: var(--space-md);
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .service-card__feature {
    display: flex;
    align-items: flex-start;
    gap: var(--space-sm);
  }

  .service-card__feature-icon {
    margin-top: 0.125rem;
    display: flex;
    height: 1.25rem;
    width: 1.25rem;
    flex-shrink: 0;
    align-items: center;
    justify-content: center;
    border-radius: 9999px;
  }

  .service-card__feature-icon--primary {
    background-color: rgba(42, 143, 255, 0.1);
    color: var(--color-primary);
  }

  .service-card__feature-icon--secondary {
    background-color: rgba(34, 176, 126, 0.1);
    color: var(--color-secondary);
  }

  .service-card__feature-text {
    color: var(--color-text-secondary);
    font-size: var(--font-size-sm);
    line-height: var(--line-height-relaxed);
  }

  .service-card__cta {
    margin-top: auto;
  }
</style>
