---
import SectionHeader from "@/components/layouts/SectionHeader.astro";
import ServiceCard from "@/components/layouts/ServiceCard.astro";
import Card from "@/components/ui/Card.astro";
import Button from "@/components/ui/Button.astro";
import { getAllServices } from "@/utils/services";
import { getArrowRightIcon } from "@/utils/icons";

const services = await getAllServices();
---

<section id="services" class="services-section scroll-reveal">
  <div class="container">
    <SectionHeader
      title="Professional Services"
      subtitle="Technical solutions and consulting tailored to your project's needs."
    />

    <div class="services-grid mb-4xl">
      {
        services.map(({ data: service }) => (
          <ServiceCard
            name={service.name}
            subtitle={service.subtitle}
            description={service.description}
            features={service.features}
            cta={service.cta}
            featured={service.featured}
          />
        ))
      }
    </div>

    <!-- Bottom CTA -->
    <div class="bottom-cta">
      <Card class="mx-auto max-w-3xl">
        <h3 class="text-primary mb-md text-2xl font-bold">
          Can't find what you need?
        </h3>
        <p class="text-secondary mb-lg leading-relaxed">
          Every project is unique. Let's talk about your specific needs and
          create a custom solution.
        </p>
        <Button href="#contact">
          Let's discuss your project
          <span set:html={getArrowRightIcon(16, 16)} />
        </Button>
      </Card>
    </div>
  </div>
</section>

<style>
  .services-grid {
    display: grid;
    gap: var(--space-2xl);
    grid-template-columns: 1fr;
    align-items: start;
  }

  @media (min-width: 768px) {
    .services-grid {
      grid-template-columns: repeat(2, 1fr);
      gap: var(--space-xl) var(--space-lg);
    }
  }

  @media (min-width: 1024px) {
    .services-grid {
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: var(--space-xl) var(--space-lg);
      max-width: 1400px;
      margin: 0 auto;
      justify-items: center;
    }
  }

  @media (min-width: 1200px) {
    .services-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: var(--space-xl);
    }
  }

  /* Ensure proper spacing for cards in multiple rows */
  .services-grid > * {
    width: 100%;
    max-width: 350px;
  }

  /* Bottom CTA styling */
  .bottom-cta {
    margin-top: var(--space-4xl);
    text-align: center;
    position: relative;
    z-index: 1;
    clear: both;
  }

  /* Ensure services section doesn't overlap */
  .services-section {
    position: relative;
    z-index: auto;
  }
</style>
